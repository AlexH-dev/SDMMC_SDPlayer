#define SYSTICK_FREQ 1000000 // 1 MHz for 1us resolution

static volatile uint32_t tickCounter = 0;

void SysTick_Handler(void) {
    tickCounter++;
}

void SysTick_Init_us(void) {
    // Set SysTick to interrupt at 1MHz (1us interval)
    SysTick_Config(SystemCoreClock / SYSTICK_FREQ);
}

void delay_us(uint32_t us) {
    uint32_t start = tickCounter;
    while ((tickCounter - start) < us) {
        __NOP(); // No operation - just wait
    }
}

void delay_ms(uint32_t ms) {
    delay_us(ms * 1000);
}
